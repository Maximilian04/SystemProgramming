Turbo Assembler	 Version 4.1	    02/17/23 09:18:32	    Page 1
scn&prt.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     locals @@
      4				     org 100h
      5
      6	0100			     Start:
      7	0100  BB 0000				     mov bx, 0d			     ; Scan number to stack
      8	0103  E8 0031				     call ScanNDec
      9	0106  53				     push bx
     10	0107  BB 0000				     mov bx, 0d			     ; Scan number to stack
     11	010A  E8 002A				     call ScanNDec
     12	010D  53				     push bx
     13
     14	010E  58				     pop ax			     ; Addiction
     15	010F  5B				     pop bx
     16	0110  03 D8				     add bx, ax
     17	0112  53				     push bx
     18
     19	0113  B8 B800				     mov ax, 0b800h		     ; адрес сегмента с		    +
     20				     видеопамятью -> es
     21	0116  8E C0				     mov es, ax			     ;
     22	0118  B6 02				     mov dh, 00000010b		     ; Dark green on black
     23
     24	011A  58				     pop ax			     ; Scanned number
     25	011B  50				     push ax			     ;
     26
     27	011C  BB 0C30				     mov bx, 160d*19 + 160d/2	     ; Середина	строчки
     28
     29	011F  E8 0067				     call PrintNDec
     30
     31
     32	0122  58				     pop ax			     ; Scanned number
     33	0123  50				     push ax			     ;
     34
     35	0124  BB 0CD0				     mov bx, 160d*20 + 160d/2	     ; Середина	строчки
     36
     37	0127  E8 003F				     call PrintNHex
     38
     39
     40	012A  58				     pop ax			     ; Scanned number
     41	012B  50				     push ax			     ;
     42
     43	012C  BB 0D70				     mov bx, 160d*21 + 160d/2	     ; Середина	строчки
     44
     45	012F  E8 0023				     call PrintNBin
     46
     47	0132  B8 4C00				     mov ax, 4c00h		     ; exit(0)
     48	0135  CD 21				     int 21h
     49
     50				     include ..\LianLib\ScanNDec.asm
1    51				     ;------------------------------------------------
1    52				     ; Scans number as decimal
1    53				     ;------------------------------------------------
1    54				     ; Entry:	     none
1    55				     ;
1    56				     ; Expects:	     BX	= 0
1    57				     ;
Turbo Assembler	 Version 4.1	    02/17/23 09:18:32	    Page 2
scn&prt.asm



1    58				     ; Exit:	     BX	= number to print
1    59				     ;
1    60				     ; Destroys:     AX	CL Si
1    61				     ;------------------------------------------------
1    62				     ;------------------------------------------------
1    63	0137			     ScanNDec	     proc
1    64
1    65	0137			     @@ScanDigit:				     ; <??????????????????????????
1    66										     ;				 ?
1    67	0137  B4 01				     mov ah, 01h		     ; getc -> al		 ?
1    68	0139  CD 21				     int 21h			     ; ^			 ?
1    69										     ;				 ?
1    70	013B  3C 0D				     cmp al, 13d		     ; Stop scan if enter	 ?
1    71	013D  74 15				     je	@@EndScanDigit		     ; >>?????????????????????????????????
1    72										     ;				 ?	 ?
1    73	013F  8A C8				     mov cl, al			     ; Store al	to cl		 ?	 ?
1    74										     ;				 ?	 ?
1    75	0141  8B C3				     mov ax, bx			     ; bx *= 10			 ?	 ?
1    76	0143  BE 000A				     mov si, 10d		     ; ^			 ?	 ?
1    77	0146  F7 E6				     mul si			     ; ^			 ?	 ?
1    78	0148  8B D8				     mov bx, ax			     ; ^			 ?	 ?
1    79										     ;				 ?	 ?
1    80	014A  8A C1				     mov al, cl			     ; Retore al from cl	 ?	 ?
1    81										     ;				 ?	 ?
1    82	014C  2C 30				     sub al, "0"		     ; ASCII "0" offset		 ?	 ?
1    83										     ;				 ?	 ?
1    84	014E  B4 00				     mov ah, 0d			     ; bx += al			 ?	 ?
1    85	0150  03 D8				     add bx, ax			     ; ^			 ?	 ?
1    86										     ;				 ?	 ?
1    87	0152  EB E3				     jmp @@ScanDigit		     ; >??????????????????????????	 ?
1    88										     ;					 ?
1    89	0154			     @@EndScanDigit:				     ; <<?????????????????????????????????
1    90	0154  C3				     ret
1    91
1    92	0155			     ScanNDec	     endp
1    93
1    94				     ;------------------------------------------------
1    95				     ;------------------------------------------------
1    96
     97				     include ..\LianLib\PrntNBin.asm
1    98				     ;------------------------------------------------
1    99				     ; Prints number as	binary to vidmem
1   100				     ;------------------------------------------------
1   101				     ; Entry:	     AX	= number to print
1   102				     ;		     BX	= start	addr to	print
1   103				     ;
1   104				     ; Expects:	     ES	-> Video segment
1   105				     ;		     DH	= color	code
1   106				     ;
1   107				     ; Exit:	     None
1   108				     ;
1   109				     ; Destroys:     AX	BX CX DL
1   110				     ;------------------------------------------------
1   111				     ;------------------------------------------------
1   112	0155			     PrintNBin	     proc
1   113
1   114	0155  B9 0010				     mov cx, 16d		     ; 16 bit in 2 byte	in ax
Turbo Assembler	 Version 4.1	    02/17/23 09:18:32	    Page 3
scn&prt.asm



1   115
1   116	0158			     @@PrintDigit:				     ; <-------------------------\
1   117										     ;				 |
1   118	0158  B2 01				     mov dl, 00000001b		     ; Mask			 |
1   119	015A  22 D0				     and dl, al			     ;				 |
1   120	015C  80 C2 30				     add dl, 30h		     ; ASCII "0" offset		 |
1   121										     ;				 |
1   122	015F  26: 89 17				     mov word ptr es:[bx], dx	     ; Print dl	on position bx	 |
1   123										     ;				 |
1   124	0162  4B				     dec bx			     ; Next digit		 |
1   125	0163  4B				     dec bx			     ; ^			 |
1   126										     ;				 |
1   127	0164  D1 E8				     shr ax, 1d			     ; ax >> 1			 |
1   128										     ;				 |
1   129	0166  E2 F0				     loop @@PrintDigit		     ; >-------------------------/
1   130
1   131	0168  C3				     ret
1   132
1   133	0169			     PrintNBin	     endp
1   134
1   135				     ;------------------------------------------------
1   136				     ;------------------------------------------------
1   137
    138				     include ..\LianLib\PrntNHex.asm
1   139				     ;------------------------------------------------
1   140				     ; Prints number as	hexagen	to vidmem
1   141				     ;------------------------------------------------
1   142				     ; Entry:	     AX	= number to print
1   143				     ;		     BX	= start	addr to	print
1   144				     ;
1   145				     ; Expects:	     ES	-> Video segment
1   146				     ;		     DH	= color	code
1   147				     ;
1   148				     ; Exit:	     None
1   149				     ;
1   150				     ; Destroys:     AX	BX CX DL Si
1   151				     ;------------------------------------------------
1   152				     ;------------------------------------------------
1   153	0169			     PrintNHex	     proc
1   154
1   155	0169  B9 0004				     mov cx, 4d			     ; 4 digits	in 2 byte in ax
1   156
1   157	016C			     @@PrintDigit:				     ; <-------------------------\
1   158										     ;				 |
1   159	016C  B2 0F				     mov dl, 00001111b		     ; Mask			 |
1   160	016E  22 D0				     and dl, al			     ;				 |
1   161										     ;				 |
1   162	0170  8B F2				     mov si, dx			     ; dl -> si			 |
1   163	0172  83 E6 0F				     and si, 0Fh		     ;				 |
1   164										     ;				 |
1   165	0175  8A 94 0000r			     mov dl, byte ptr [Alphabet]+si  ; ASCII "0" offset		 |
1   166										     ;				 |
1   167	0179  26: 89 17				     mov word ptr es:[bx], dx	     ; Print dl	on position bx	 |
1   168										     ;				 |
1   169	017C  4B				     dec bx			     ; Next digit		 |
1   170	017D  4B				     dec bx			     ; ^			 |
1   171										     ;				 |
Turbo Assembler	 Version 4.1	    02/17/23 09:18:32	    Page 4
scn&prt.asm



1   172	017E  D1 E8 D1 E8 D1 E8	D1+		     shr ax, 4d			     ; ax >> 4			 |
    173	      E8
1   174										     ;				 |
1   175	0186  E2 E4				     loop @@PrintDigit		     ; >-------------------------/
1   176
1   177	0188  C3				     ret
1   178
1   179	0189			     PrintNHex	     endp
1   180
1   181				     ;------------------------------------------------
1   182				     ;------------------------------------------------
1   183
    184				     include ..\LianLib\PrntNDec.asm
1   185				     ;------------------------------------------------
1   186				     ; Prints number as	decimal	to vidmem
1   187				     ;------------------------------------------------
1   188				     ; Entry:	     AX	= number to print
1   189				     ;		     BX	= start	addr to	print
1   190				     ;
1   191				     ; Expects:	     ES	-> Video segment
1   192				     ;		     DH	= color	code
1   193				     ;
1   194				     ; Exit:	     None
1   195				     ;
1   196				     ; Destroys:     AX	BX CX DL Si
1   197				     ;------------------------------------------------
1   198				     ;------------------------------------------------
1   199	0189			     PrintNDec	     proc
1   200
1   201	0189  B9 0005				     mov cx, 5d			     ; 5 digits	in 2 byte in ax
1   202
1   203	018C			     @@PrintDigit:				     ; <-------------------------\
1   204	018C  8A EE				     mov ch, dh			     ; Store dh	to ch		 |
1   205										     ;				 |
1   206	018E  BA 0000				     mov dx, 0d			     ; for division		 |
1   207	0191  BE 000A				     mov si, 10d		     ; ax/10 ->	ax &		 |
1   208	0194  F7 F6				     div si			     ; & ax%10 -> dx		 | !!! dx < 10
1   209										     ;				 |
1   210	0196  8B F2				     mov si, dx			     ; dl -> si			 |
1   211										     ;				 |
1   212	0198  8A 94 0000r			     mov dl, byte ptr [Alphabet]+si  ; ASCII "0" offset		 |
1   213										     ;				 |
1   214	019C  8A F5				     mov dh, ch			     ; Restore dh from ch	 |
1   215	019E  B5 00				     mov ch, 0			     ; ^			 |
1   216										     ;				 |
1   217	01A0  26: 89 17				     mov word ptr es:[bx], dx	     ; Print dl	on position bx	 |
1   218										     ;				 |
1   219	01A3  4B				     dec bx			     ; Next digit		 |
1   220	01A4  4B				     dec bx			     ; ^			 |
1   221										     ;				 |
1   222										     ;				 |
1   223	01A5  E2 E5				     loop @@PrintDigit		     ; >-------------------------/
1   224
1   225	01A7  C3				     ret
1   226
1   227	01A8			     PrintNDec	     endp
1   228
Turbo Assembler	 Version 4.1	    02/17/23 09:18:32	    Page 5
scn&prt.asm



1   229				     ;------------------------------------------------
1   230				     ;------------------------------------------------
1   231
    232
    233	01A8			     .data
    234				     include ..\LianLib\Alphabet.asm
1   235	0000  30 31 32 33 34 35	36+  Alphabet:	     db	"0123456789ABCDEF"	     ; Alphabet	for printing (Thanks Ilya)
    236	      37 38 39 41 42 43	44+
    237	      45 46
1   238
    239
    240				     end	     Start
Turbo Assembler	 Version 4.1	    02/17/23 09:18:32	    Page 6
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/17/23"
??FILENAME			  Text	 "scn&prt "
??TIME				  Text	 "09:18:32"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@ENDSCANDIGIT			  Near	 DGROUP:0154
@@PRINTDIGIT			  Near	 DGROUP:0158
@@PRINTDIGIT			  Near	 DGROUP:016C
@@PRINTDIGIT			  Near	 DGROUP:018C
@@SCANDIGIT			  Near	 DGROUP:0137
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _DATA
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 SCN&PRT
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ALPHABET			  Near	 DGROUP:0000
PRINTNBIN			  Near	 DGROUP:0155
PRINTNDEC			  Near	 DGROUP:0189
PRINTNHEX			  Near	 DGROUP:0169
SCANNDEC			  Near	 DGROUP:0137
START				  Near	 DGROUP:0100

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0010 Word	  Public  DATA
  _TEXT				  16  01A8 Word	  Public  CODE
