Turbo Assembler	 Version 4.1	    02/17/23 03:01:17	    Page 1
scn&prt.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     locals @@
      4				     org 100h
      5
      6	0100			     Start:
      7	0100  BB 0000				     mov bx, 0d			     ; Scan number to bx
      8	0103  E8 0025				     call ScanNDec
      9	0106  53				     push bx
     10
     11	0107  B8 B800				     mov ax, 0b800h		     ; адрес сегмента с		    +
     12				     видеопамятью -> es
     13	010A  8E C0				     mov es, ax			     ;
     14	010C  B6 02				     mov dh, 00000010b		     ; Dark green on black
     15
     16	010E  58				     pop ax			     ; Scanned number
     17	010F  50				     push ax			     ;
     18
     19	0110  BB 0C30				     mov bx, 160d*19 + 160d/2	     ; Середина	строчки
     20
     21	0113  E8 0067				     call PrintNDec
     22
     23
     24	0116  58				     pop ax			     ; Scanned number
     25	0117  50				     push ax			     ;
     26
     27	0118  BB 0CD0				     mov bx, 160d*20 + 160d/2	     ; Середина	строчки
     28
     29	011B  E8 003F				     call PrintNHex
     30
     31
     32	011E  58				     pop ax			     ; Scanned number
     33	011F  50				     push ax			     ;
     34
     35	0120  BB 0D70				     mov bx, 160d*21 + 160d/2	     ; Середина	строчки
     36
     37	0123  E8 0023				     call PrintNBin
     38
     39	0126  B8 4C00				     mov ax, 4c00h		     ; exit(0)
     40	0129  CD 21				     int 21h
     41
     42				     include ..\LianLib\ScanNDec.asm
1    43				     ;------------------------------------------------
1    44				     ; Scans number as decimal
1    45				     ;------------------------------------------------
1    46				     ; Entry:	     none
1    47				     ;
1    48				     ; Expects:	     BX	= 0
1    49				     ;
1    50				     ; Exit:	     BX	= number to print
1    51				     ;
1    52				     ; Destroys:     AX	CL Si
1    53				     ;------------------------------------------------
1    54				     ;------------------------------------------------
1    55	012B			     ScanNDec	     proc
1    56
1    57	012B			     @@ScanDigit:				     ; <??????????????????????????
Turbo Assembler	 Version 4.1	    02/17/23 03:01:17	    Page 2
scn&prt.asm



1    58										     ;				 ?
1    59	012B  B4 01				     mov ah, 01h		     ; getc -> al		 ?
1    60	012D  CD 21				     int 21h			     ; ^			 ?
1    61										     ;				 ?
1    62	012F  3C 0D				     cmp al, 13d		     ; Stop scan if enter	 ?
1    63	0131  74 15				     je	@@EndScanDigit		     ; >>?????????????????????????????????
1    64										     ;				 ?	 ?
1    65	0133  8A C8				     mov cl, al			     ; Store al	to cl		 ?	 ?
1    66										     ;				 ?	 ?
1    67	0135  8B C3				     mov ax, bx			     ; bx *= 10			 ?	 ?
1    68	0137  BE 000A				     mov si, 10d		     ; ^			 ?	 ?
1    69	013A  F7 E6				     mul si			     ; ^			 ?	 ?
1    70	013C  8B D8				     mov bx, ax			     ; ^			 ?	 ?
1    71										     ;				 ?	 ?
1    72	013E  8A C1				     mov al, cl			     ; Retore al from cl	 ?	 ?
1    73										     ;				 ?	 ?
1    74	0140  2C 30				     sub al, "0"		     ; ASCII "0" offset		 ?	 ?
1    75										     ;				 ?	 ?
1    76	0142  B4 00				     mov ah, 0d			     ; bx += al			 ?	 ?
1    77	0144  03 D8				     add bx, ax			     ; ^			 ?	 ?
1    78										     ;				 ?	 ?
1    79	0146  EB E3				     jmp @@ScanDigit		     ; >??????????????????????????	 ?
1    80										     ;					 ?
1    81	0148			     @@EndScanDigit:				     ; <<?????????????????????????????????
1    82	0148  C3				     ret
1    83
1    84	0149			     ScanNDec	     endp
1    85
1    86				     ;------------------------------------------------
1    87				     ;------------------------------------------------
1    88
     89				     include ..\LianLib\PrntNBin.asm
1    90				     ;------------------------------------------------
1    91				     ; Prints number as	binary to vidmem
1    92				     ;------------------------------------------------
1    93				     ; Entry:	     AX	= number to print
1    94				     ;		     BX	= start	addr to	print
1    95				     ;
1    96				     ; Expects:	     ES	-> Video segment
1    97				     ;		     DH	= color	code
1    98				     ;
1    99				     ; Exit:	     None
1   100				     ;
1   101				     ; Destroys:     AX	BX CX DL
1   102				     ;------------------------------------------------
1   103				     ;------------------------------------------------
1   104	0149			     PrintNBin	     proc
1   105
1   106	0149  B9 0010				     mov cx, 16d		     ; 16 bit in 2 byte	in ax
1   107
1   108	014C			     @@PrintDigit:				     ; <-------------------------\
1   109										     ;				 |
1   110	014C  B2 01				     mov dl, 00000001b		     ; Mask			 |
1   111	014E  22 D0				     and dl, al			     ;				 |
1   112	0150  80 C2 30				     add dl, 30h		     ; ASCII "0" offset		 |
1   113										     ;				 |
1   114	0153  26: 89 17				     mov word ptr es:[bx], dx	     ; Print dl	on position bx	 |
Turbo Assembler	 Version 4.1	    02/17/23 03:01:17	    Page 3
scn&prt.asm



1   115										     ;				 |
1   116	0156  4B				     dec bx			     ; Next digit		 |
1   117	0157  4B				     dec bx			     ; ^			 |
1   118										     ;				 |
1   119	0158  D1 E8				     shr ax, 1d			     ; ax >> 1			 |
1   120										     ;				 |
1   121	015A  E2 F0				     loop @@PrintDigit		     ; >-------------------------/
1   122
1   123	015C  C3				     ret
1   124
1   125	015D			     PrintNBin	     endp
1   126
1   127				     ;------------------------------------------------
1   128				     ;------------------------------------------------
1   129
    130				     include ..\LianLib\PrntNHex.asm
1   131				     ;------------------------------------------------
1   132				     ; Prints number as	hexagen	to vidmem
1   133				     ;------------------------------------------------
1   134				     ; Entry:	     AX	= number to print
1   135				     ;		     BX	= start	addr to	print
1   136				     ;
1   137				     ; Expects:	     ES	-> Video segment
1   138				     ;		     DH	= color	code
1   139				     ;
1   140				     ; Exit:	     None
1   141				     ;
1   142				     ; Destroys:     AX	BX CX DL Si
1   143				     ;------------------------------------------------
1   144				     ;------------------------------------------------
1   145	015D			     PrintNHex	     proc
1   146
1   147	015D  B9 0004				     mov cx, 4d			     ; 4 digits	in 2 byte in ax
1   148
1   149	0160			     @@PrintDigit:				     ; <-------------------------\
1   150										     ;				 |
1   151	0160  B2 0F				     mov dl, 00001111b		     ; Mask			 |
1   152	0162  22 D0				     and dl, al			     ;				 |
1   153										     ;				 |
1   154	0164  8B F2				     mov si, dx			     ; dl -> si			 |
1   155	0166  83 E6 0F				     and si, 0Fh		     ;				 |
1   156										     ;				 |
1   157	0169  8A 94 0000r			     mov dl, byte ptr [Alphabet]+si  ; ASCII "0" offset		 |
1   158										     ;				 |
1   159	016D  26: 89 17				     mov word ptr es:[bx], dx	     ; Print dl	on position bx	 |
1   160										     ;				 |
1   161	0170  4B				     dec bx			     ; Next digit		 |
1   162	0171  4B				     dec bx			     ; ^			 |
1   163										     ;				 |
1   164	0172  D1 E8 D1 E8 D1 E8	D1+		     shr ax, 4d			     ; ax >> 4			 |
    165	      E8
1   166										     ;				 |
1   167	017A  E2 E4				     loop @@PrintDigit		     ; >-------------------------/
1   168
1   169	017C  C3				     ret
1   170
1   171	017D			     PrintNHex	     endp
Turbo Assembler	 Version 4.1	    02/17/23 03:01:17	    Page 4
scn&prt.asm



1   172
1   173				     ;------------------------------------------------
1   174				     ;------------------------------------------------
1   175
    176				     include ..\LianLib\PrntNDec.asm
1   177				     ;------------------------------------------------
1   178				     ; Prints number as	decimal	to vidmem
1   179				     ;------------------------------------------------
1   180				     ; Entry:	     AX	= number to print
1   181				     ;		     BX	= start	addr to	print
1   182				     ;
1   183				     ; Expects:	     ES	-> Video segment
1   184				     ;		     DH	= color	code
1   185				     ;
1   186				     ; Exit:	     None
1   187				     ;
1   188				     ; Destroys:     AX	BX CX DL Si
1   189				     ;------------------------------------------------
1   190				     ;------------------------------------------------
1   191	017D			     PrintNDec	     proc
1   192
1   193	017D  B9 0005				     mov cx, 5d			     ; 5 digits	in 2 byte in ax
1   194
1   195	0180			     @@PrintDigit:				     ; <-------------------------\
1   196	0180  8A EE				     mov ch, dh			     ; Store dh	to ch		 |
1   197										     ;				 |
1   198	0182  BA 0000				     mov dx, 0d			     ; for division		 |
1   199	0185  BE 000A				     mov si, 10d		     ; ax/10 ->	ax &		 |
1   200	0188  F7 F6				     div si			     ; & ax%10 -> dx		 | !!! dx < 10
1   201										     ;				 |
1   202	018A  8B F2				     mov si, dx			     ; dl -> si			 |
1   203										     ;				 |
1   204	018C  8A 94 0000r			     mov dl, byte ptr [Alphabet]+si  ; ASCII "0" offset		 |
1   205										     ;				 |
1   206	0190  8A F5				     mov dh, ch			     ; Restore dh from ch	 |
1   207	0192  B5 00				     mov ch, 0			     ; ^			 |
1   208										     ;				 |
1   209	0194  26: 89 17				     mov word ptr es:[bx], dx	     ; Print dl	on position bx	 |
1   210										     ;				 |
1   211	0197  4B				     dec bx			     ; Next digit		 |
1   212	0198  4B				     dec bx			     ; ^			 |
1   213										     ;				 |
1   214										     ;				 |
1   215	0199  E2 E5				     loop @@PrintDigit		     ; >-------------------------/
1   216
1   217	019B  C3				     ret
1   218
1   219	019C			     PrintNDec	     endp
1   220
1   221				     ;------------------------------------------------
1   222				     ;------------------------------------------------
1   223
    224
    225	019C			     .data
    226				     include ..\LianLib\Alphabet.asm
1   227	0000  30 31 32 33 34 35	36+  Alphabet:	     db	"0123456789ABCDEF"	     ; Alphabet	for printing (Thanks Ilya)
    228	      37 38 39 41 42 43	44+
Turbo Assembler	 Version 4.1	    02/17/23 03:01:17	    Page 5
scn&prt.asm



    229	      45 46
1   230
    231
    232				     end	     Start
Turbo Assembler	 Version 4.1	    02/17/23 03:01:17	    Page 6
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/17/23"
??FILENAME			  Text	 "scn&prt "
??TIME				  Text	 "03:01:17"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@ENDSCANDIGIT			  Near	 DGROUP:0148
@@PRINTDIGIT			  Near	 DGROUP:014C
@@PRINTDIGIT			  Near	 DGROUP:0160
@@PRINTDIGIT			  Near	 DGROUP:0180
@@SCANDIGIT			  Near	 DGROUP:012B
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _DATA
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 SCN&PRT
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ALPHABET			  Near	 DGROUP:0000
PRINTNBIN			  Near	 DGROUP:0149
PRINTNDEC			  Near	 DGROUP:017D
PRINTNHEX			  Near	 DGROUP:015D
SCANNDEC			  Near	 DGROUP:012B
START				  Near	 DGROUP:0100

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0010 Word	  Public  DATA
  _TEXT				  16  019C Word	  Public  CODE
